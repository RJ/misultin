<html>
    <head>
        <style>
        #webSocketContainer {
            top: 3px !important;
            left: 3px !important;
        }
        </style>
        <script>
        WEB_SOCKET_DEBUG = true;
        WEB_SOCKET_SWF_LOCATION = '/WebSocketMain.swf';
        WEB_SOCKET_DISABLE_AUTO_INITIALIZATION = true;
        </script>
        <script src="/swfobject.js"></script>
        <script src="/web_socket.js"></script>
        <script type="text/javascript">
            function addStatus(text){
                var date = new Date();
                document.getElementById('status').innerHTML = document.getElementById('status').innerHTML + date + ": " + text + "<br>";
            }
            function ready () {
                if (!window.WebSocket) {
                    WebSocket = FlashSocket;
                    WebSocket.__initialize();
                }
                var ws;
                var protocol = window.location.protocol === 'https:' ? 'wss' : 'ws';
                var host = protocol + '://' + window.location.host;
                var endpoint = host + '/service';
                if ("WebSocket" in window) {
                    ws = new WebSocket(endpoint);
                } else if ("MozWebSocket" in window) {
                    ws = new MozWebSocket(endpoint);
                }
                if (ws) {
                    // browser supports websockets
                    ws.onopen = function() {
                        // websocket is connected
                        addStatus("websocket connected!");
                        // send hello data to server.
                        ws.send("hello server!");
                        addStatus("sent message to server: 'hello server'!");
                    };
                    ws.onmessage = function (evt) {
                        var receivedMsg = evt.data;
                        addStatus("server sent the following: '" + receivedMsg + "'");
                    };
                    ws.onclose = function() {
                        // websocket was closed
                        addStatus("websocket was closed");
                    };
                } else {
                    // browser does not support websockets
                    addStatus("sorry, your browser does not support websockets.");
                }
            }
        </script>
    </head>
    <body onload="ready();">
            <div id="status"></div>
    </body>
</html>
